<odoo>
  <data>

    <record id="book_search_view" model="ir.ui.view">
      <field name="name">book.search.view</field>
      <field name="model">book</field>
      <field name="arch" type="xml">
        <search>
          <field name="name" />
          <field name="isbn" />
          <field name="author" />
          <field name="genre" />
          <field name="category" />
          <field name="editorial" />
          <field name="tags" />
          <group>
            <filter name="loans" string="No loans" domain="[('loans', '=' , False)]" />
            <filter name="reservations" string="No reservations"
              domain="[('reservations', '=' , False)]" />
            <filter name="archived" string="Archived"
              domain="[('active', '!=' , 'true')]" />
          </group>
          <group expand="0" string="Book info">
            <filter name="state" string="State" domain="[('state','=','self')]"
              context="{'group_by':'state'}" />
            <filter name="author" string="Author" domain="[('author', '=' , 'self')]"
              context="{'group_by':'author'}" />
            <filter name="editorial" string="Editorial" domain="[('editorial','=','self')]"
              context="{'group_by':'editorial'}" />
            <field name="published_date" />
            <filter name="group_by_date" string="Published date"
              context="{'group_by': 'published_date:month'}" />
          </group>
        </search>
      </field>
    </record>

    <record id="book_tree_view" model="ir.ui.view">
      <field name="name">book.tree.view</field>
      <field name="model">book</field>
      <field name="arch" type="xml">
        <tree>
          <field name="name" />
          <field name="author" />
          <field name="editorial" />
          <field name="genre" widget="many2many_tags" />
          <field name="state" />
        </tree>
      </field>
    </record>

    <record id="book_form_view" model="ir.ui.view">
      <field name="name">book.form.view</field>
      <field name="model">book</field>
      <field name="arch" type="xml">
        <form>
          <header>
            <button class="btn btn-primary" type="object" string="Available"
              name="action_available"
              invisible="state not in ('borrowed', 'damaged', 'lost', 'repairing','not available','archived')" />
            <button class="btn btn-primary" type="object" string="Borrowed" name="action_borrowed"
              invisible="state not in ('available', 'damaged', 'lost', 'repairing','not available','archived')" />
            <button class="btn"
              type="object" string="Damaged"
              name="action_damaged"
              invisible="state not in ('borrowed', 'available', 'lost', 'repairing','not available','archived')" />
            <button class="btn"
              type="object" string="Repairing"
              name="action_repairing"
              invisible="state not in ('borrowed', 'damaged', 'lost', 'available','not available','archived')" />
            <button class="btn" type="object" string="Lost" name="action_lost"
              invisible="state not in ('borrowed', 'damaged', 'available', 'repairing','available', 'not available', 'archived')" />
            <button type="object" string="Not available" name="action_not_available"
              invisible="state not in ('borrowed', 'damaged', 'lost', 'repairing','available','archived')" />
            <button type="object" string="Archived" name="action_archived"
              invisible="state not in ('borrowed', 'damaged', 'lost', 'repairing','not available','available')" />
            <field widget="statusbar" readonly="0" name="state"
              statusbar_visible="available, borrowed, damaged, repairing, lost, not available, archived" />
          </header>
          <sheet>
            <group>
              <group>
                <field name="name" />
              </group>
              <group>
                <field name="author" />
              </group>
              <group>
                <field name="isbn" />
              </group>
              <group>
                <field name="editorial" options="{'no_create': True}" widget="many2one"/>
              </group>
            </group>
            <group>
              <group>
                <field name="genre" widget="many2many_tags" options="{'color_field': 'color'}" />
              </group>
              <group>
                <field name="published_date" />
              </group>
            </group>
            <notebook>
              <page string="Loans">
                <field name="loans">
                  <tree decoration-danger="not_returned">
                    <field name="partner_id" string="Contact" />
                    <field name="start_date" string="Start Date" />
                    <field name="end_date" string="End Date" />
                    <field name="not_returned" column_invisible="1" />
                  </tree>
                  <form>
                    <group>
                      <field name="partner_id" />
                      <field name="start_date" />
                      <field name="end_date" />
                      
                    </group>
                  </form>
                </field>
              </page>
              <page string="Reservations">
                <field name="reservations">
                  <tree>
                    <field name="partner_id" string="Contact" />
                    <field name="date" string="Start Date" />
                  </tree>
                  <form>
                    <group>
                      <field name="partner_id" />
                      <field name="date" />
                    </group>
                  </form>
                  
                </field>
              </page>
              <page string="Other information">
                <group>
                  <field name="tags" widget="many2many_tags" options="{'color_field': 'color'}" />
                </group>
                <group>
                  <field name="category" widget="many2many_tags" options="{'color_field': 'color'}" />
                </group>
                <group>
                  <field name="summary" />
                </group>
                <group>
                  <field name="description" />
                </group>
                <group>
                  <field name="active" />
                </group>
              </page>
            </notebook>
          </sheet>
          <div class="oe_chatter">
            <field widget="mail_thread" name="message_ids" />
            <field widget="mail_activity" name="activity_ids" />
          </div>
        </form>
      </field>
    </record>

    <record id="book_action" model="ir.actions.act_window">
      <field name="name">Books</field>
      <field name="res_model">book</field>
      <field name="view_mode">search,tree,form</field>
    </record>

  </data>
</odoo>
